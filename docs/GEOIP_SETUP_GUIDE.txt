ğŸ“ GEOIP DATABASE SETUP GUIDE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… STATUS: app_auto.py is configured and ready for GeoLite2

WHAT YOU NEED TO DO:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Download MaxMind GeoLite2-Country Database:

   a) Go to: https://www.maxmind.com/en/geolite2/signup
   
   b) Create a FREE account and confirm your email
   
   c) Download "GeoLite2-Country" (MMDB format)
      File name: GeoLite2-Country.mmdb (~37 MB)
   
   d) Copy the file to: C:\project\data\GeoLite2-Country.mmdb
      
      Using PowerShell:
      $file = "C:\Downloads\GeoLite2-Country.mmdb"
      Copy-Item $file "C:\project\data\GeoLite2-Country.mmdb"


2. Verify Installation:

   The app will automatically detect the database file.
   
   Check the Streamlit logs for: "[âœ“] GeoIP database loaded"
   
   OR you can test directly in PowerShell:
   
   cd C:\project
   python -c "from pathlib import Path; db = Path('data/GeoLite2-Country.mmdb'); print(f'Database exists: {db.exists()}'); print(f'File size: {db.stat().st_size / (1024*1024):.1f} MB' if db.exists() else '')"


3. What Happens When Active:

   âœ“ All src_ip addresses are automatically geo-enriched
   âœ“ src_country column populated with ISO country codes
   âœ“ Geography tab in dashboard shows country distribution
   âœ“ No internet API calls required (fully offline)


TROUBLESHOOTING:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Problem: "Could not load GeoIP database" warning in Streamlit
Solution: 
  1. Verify file exists: ls C:\project\data\GeoLite2-Country.mmdb
  2. Verify file is NOT corrupted (size should be ~37 MB)
  3. Restart Streamlit: streamlit run app_auto.py

Problem: GeoLite2 file not recognized
Solution:
  1. Ensure correct filename: GeoLite2-Country.mmdb (exact spelling)
  2. Ensure correct folder: data/ subfolder of project root
  3. Don't use any other MaxMind database (like ASN, City, etc.)

Problem: No src_country values appearing
Solution:
  1. Ensure at least one record has a valid src_ip address
  2. Check that src_ip column isn't all 127.0.0.1 or "localhost"
  3. Public IPs will be resolved; private IPs return None (expected)


HOW THE CODE WORKS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

In app_auto.py:

1. GeoIP database path defined:
   GEOIP_DB_PATH = ROOT / "data" / "GeoLite2-Country.mmdb"

2. Lazy reader function (loaded once):
   get_geoip_reader() â†’ loads geoip2.database.Reader()

3. IP lookup function:
   lookup_country_maxmind(ip) â†’ returns ISO country code (e.g., "US", "CN")

4. DataFrame enrichment:
   enrich_geo(df) â†’ adds src_country column to all rows

5. Auto-called in data pipeline:
   - After CSV load (line 293)
   - After normalization (line 314)
   - Caches results per IP for performance


PERFORMANCE NOTES:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

- First 100 unique IPs: ~50-100ms (database file I/O)
- Subsequent IPs: Instant (Python dict caching)
- Memory: ~30-50 MB for GeoLite2-Country database
- No external API calls = no rate limits, no internet required


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
After setup, Geography tab will auto-populate with:
  - Country code distribution (pie chart)
  - Country flags + session counts
  - Attack patterns by geography
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
